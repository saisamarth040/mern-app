
  exports.product_create = async (req, res) => {
      try {
        const unique_no = req.body.unique_no;
        const pieces = req.body.pieces;
        const city = req.body.city;
        const status = req.body.status;
        const formattedDate = new Date().toLocaleString("en-US", { timeZone: "Asia/Kolkata" });
        let product = await Product.findOne({ unique_no });
        if (product) {
          console.log("product exit")
          if (product.status === "Pick") {
            const result = await Product.updateOne({unique_no:unique_no },  {$set:{pick_time:product.pick_time,
              pick_city:product.pick_city,
              pick_pieces:product.pick_pieces,
              status: status,
              deliver_pieces:pieces,
              deliver_time:formattedDate,
              deliver_city:city}})
            console.log("first")
            return res.status(200).json("Product delivered");
          }else{
            console.log("Product status is Deliver");
            return res.status(401).json("product code no doesn't vaild!");
          }
        } else {
          console.log("Product does not exist");
    
          if (status === "Deliver") {
            console.log("Cannot deliver a product that has not been picked yet");
            return res
              .status(401)
              .json({ message: "Please first pick this product, then deliver" });
          }else{
             console.log("this is deliver product ");
            product = await Product.create({
              unique_no: unique_no,
              pick_pieces: pieces,
              pick_city: city,
              status: status,
              pick_time: formattedDate,
            });
      
            console.log("Product created");
            return res.status(200).json({ message: "Product created" });
          }
          
        }
      } catch (error) {
        console.log("Error:", error);
        return res.status(400).send(error);
      }
};
    






  exports.delete_product = async (req, res, next) => {
    const userId = req.query.id;
    console.log(userId)
  try {
    const deletedUser = await Product.findOneAndDelete({_id: userId});
  
      if (!deletedUser) {
        return res.status(404).json({
          success: false,
          message: 'User not found',
        });
      }
      res.status(200).json({
        success: true,
        message: 'User deleted successfully',
        data: deletedUser,
      });
  } catch (error) {
    console.log(error)
  }
  }
  

  exports.update_product = async (req, res, next) => {
    const Id = req.body.id;
    try {
      const updatedProduct = await Product.findByIdAndUpdate(Id, req.body, { new: true });
  
      if (!updatedProduct) {
        return res.status(404).json({
          success: false,
          message: 'User not found',
        });
      }
      res.status(200).json({
        success: true,
        message: 'User updated successfully',
        data: updatedProduct,
      });
    } catch (err) {
      console.error(err);
      res.status(500).json({
        success: false,
        message: 'Server error',
      });
    }
  }


  
exports.getAllUSer = async (req, res, next) => {
      const users = await User.find().exec();
      res.status(200).json({ message: "all blogs", users });
}

exports.getOneUser = async (req, res, next) => {
    try {
      const id = req.query.id;
      const user = await User.findById(id);
      if (!user) {
        res.status(404).json({ message: 'User not found' });
        return;
      }
     return res.status(200).json({ message: "user", user });
    } catch (error) {
      console.log(error);
      res.status(500).json({ message: 'Server error' });
    }
 }

exports.delete_User = async (req, res, next) => {
    const userId = req.query.id;
  try {
    const deletedUser = await User.findOneAndDelete({_id: userId});

      if (!deletedUser) {
        return res.status(404).json({
          success: false,
          message: 'User not found',
        });
      }
      res.status(200).json({
        success: true,
        message: 'User deleted successfully',
        data: deletedUser,
      });
  } catch (error) {
    console.log(error)
  }
}

exports.update_user = async (req, res, next) => {
    const userId = req.body.id;
    try {
      const updatedUser = await User.findByIdAndUpdate(userId, req.body, { new: true });
  
      if (!updatedUser) {
        return res.status(404).json({
          success: false,
          message: 'User not found',
        });
      }
      res.status(200).json({
        success: true,
        message: 'User updated successfully',
        data: updatedUser,
      });
  
    } catch (error) {
      console.error(err);
      res.status(500).json({
        success: false,
        message: 'Server error',
      });
    }
}


  {/* <Route
          path="/update_user/:id"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <UpdateUser />
            </ProtectedRoute>
          }
          />
            <Route
          path="/update_product/:id"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <UpdateInsert />
            </ProtectedRoute>
          }
          />
          <Route
          path="/data"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <Data />
            </ProtectedRoute>
          }
          />
          <Route
          path="/create_user"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <CreateUser />
            </ProtectedRoute>
          }
          />
          
          <Route
          path="/show_user"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <ShowUser />
            </ProtectedRoute>
          }
          />
            <Route
          path="/home"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <Home />
            </ProtectedRoute>
          }
          />

<Route
          path="/show"
          element={
            <ProtectedRoute isAuthenticated={isAuthenticated} adminRoute={true}>
              <Show />
            </ProtectedRoute>
          }
          />*/}









          <ul id='menuIcon' className="navbar-nav">
    <li className="nav-item">
      <a style={{fontSize: "18px"}} className="nav-link" data-widget="pushmenu" href="#" role="button"
        ><img style={{width:"18px"}}
         src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAZlBMVEX///8AAABhYWH09PQ6Ojr7+/vx8fGVlZXt7e3U1NTj4+MfHx+mpqZra2vIyMiYmJjd3d1MTEzBwcFvb2+NjY2enp7Hx8esrKwxMTG4uLiCgoIMDAzPz89zc3M1NTW7u7tZWVlBQUEfZxDeAAAB20lEQVR4nO3d21LiQBCA4VEWFARPKIegu/r+L7m1rhcUzJXVqZ4avu8N/kqFEOh0SgEAAAAAAAAAAAAAAOCnFsv1dQvWy8UofbPVVTtWs/jAt+yoE/fRgfPsojPz2MDJXXbQmbtJaOFLdk/FS2Rgg4cw+CC2dxb+E3kmLrNjqpaBhTfZMVU3gYWv2TFVr4GFm+yYqsiL/m12TNVtYGF5z66peI8MLIvsnIrgG4xtds+ZbWxgKQ/ZRSciP0i/bXbZUUd2m/jAUqb7VRORh9+rP9MxAr8iJy0YLQ8AAAAAAHoybcF4efPh4/NXvs+P4W2Uvsen7D+djjw9xgfus6NO7KMDn7OLzjzHBrY4bhI6bFKG7JyKITJwdsjOqThEznq3NuT9X+Q1w/Rljv6nLyOPYf/nYf+fpf1fD5v8ThP86FP330sv4N7iAu4PSzv3+NdD8HNrx7J/ovkyXh4AAAAAAPSj850KrezFuNqt9qNEtrXbJPz/0fb20zxEB3a/Y6j/PVHd7/pqcdgkdoT2PjumKnLnXpuTe5Hrvvqfvux/grb/HbT97xHufxd0iwcxeJ93g2di+Gxbaxf9ER7Qa+rdCOsR3o1QGnq/xXac91sAAAAAAAAAAAAAAABchr9W6DehemiqSwAAAABJRU5ErkJggg==" alt="" /></a>
    </li> 
  </ul>




    <TableContainer>
                    <Heading className="SHow_products_heading" my="8" textAlign={'center'} size={'lg'}>
                        This Month data is here...........................
                    </Heading>
                    <Table variant='simple'>
                        <Thead w="full"
                            bg="yellow.500"
                            p="4"
                            color="#fff"
                            css={{ borderRadius: '8px 8px 0 0' }}>
                            <Tr >
                                <Th color="#fff">No.</Th>
                                <Th color="#fff">consignment_no</Th>
                                <Th color="#fff">pieces</Th>
                                <Th color="#fff">City</Th>
                                <Th color="#fff">Status</Th>
                                <Th color="#fff">Create Time</Th>
                                <Th color="#fff">update</Th>
                            </Tr>
                        </Thead>
                        {/* {data && data.map((e, i) => {
                            return <Tbody>
                                <Tr>
                                    <Td>{i + 1}</Td>
                                    <Td>{e.unique_no}</Td>
                                    <Td >{e.pieces}</Td>
                                    <Td >{e.city}</Td>
                                    <Td >{e.status}</Td>
                                    <Td >{e.createdAt.split("T")[0]}</Td>
                                    <Td>{e._id ? (<>
                                        <HStack>

                                            <Button key={i} value={e._id} onClick={delete_handler} data-key={e._id} variant={'ghost'} colorScheme={'yellow'}>
                                                <DeleteIcon w={4} h={4} color="red.500" />
                                            </Button>
                                            <Button onClick={updateHnadler} key={i} value={e._id} variant={'ghost'} colorScheme={'yellow'} data-key={e._id}>
                                                <AddIcon w={4} h={4} color="red.500" />
                                            </Button>
                                        </HStack>
                                    </>
                                    ) : "noop..."}</Td>
                                </Tr>
                            </Tbody>
                        })} */}
                    </Table>
                </TableContainer>